(()=>{"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===_typeof(i)?i:String(i)),n)}var o,i}var e=function(){function AppApi(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,AppApi),this._baseApi=e}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(AppApi,[{key:"getProductList",value:function getProductList(){return this._baseApi.get("/product").then((function(e){return e}))}},{key:"getProduct",value:function getProduct(e){return this._baseApi.get("/cards/".concat(e)).then((function(e){return e}))}},{key:"sendOrder",value:function sendOrder(e){return this._baseApi.post("/order",e).then((function(e){return e}))}}]),AppApi}();function Component_typeof(e){return Component_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Component_typeof(e)}function Component_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Component_toPrimitive(e,t){if("object"!==Component_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Component_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Component_typeof(i)?i:String(i)),n)}var o,i}var t=function(){function Component(e,t){!function Component_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Component),this.container=e,this.events=t}return function Component_createClass(e,t,r){return t&&Component_defineProperties(e.prototype,t),r&&Component_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Component,[{key:"render",value:function render(e){return this._data=e,Object.assign(this,null!=e?e:{}),this.container}}]),Component}();function BasketView_typeof(e){return BasketView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BasketView_typeof(e)}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _arrayLikeToArray(e,t)}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function BasketView_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function BasketView_toPrimitive(e,t){if("object"!==BasketView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==BasketView_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===BasketView_typeof(i)?i:String(i)),n)}var o,i}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function _possibleConstructorReturn(e,t){if(t&&("object"===BasketView_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var r,n=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(BasketView,e);var t=_createSuper(BasketView);function BasketView(e,r){var n;return function BasketView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,BasketView),(n=t.call(this,e,r)).container=e,n.itemsContainer=n.container.querySelector(".basket__list"),n.totalPrice=n.container.querySelector(".basket__price"),n.button=n.container.querySelector(".basket__button"),n.button.addEventListener("click",(function(e){e.preventDefault(),n.total>0&&r.emit("order:submit")})),n}return function BasketView_createClass(e,t,r){return t&&BasketView_defineProperties(e.prototype,t),r&&BasketView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(BasketView,[{key:"setProduct",value:function setProduct(e){var t;this._product=e,(t=this.itemsContainer).replaceChildren.apply(t,_toConsumableArray(e))}},{key:"updateTotalPrice",value:function updateTotalPrice(e){this.total=e,this.totalPrice.textContent="".concat(e," синапсов")}},{key:"product",get:function get(){return this._product}},{key:"element",get:function get(){return this.container}},{key:"setSubmitDisabled",value:function setSubmitDisabled(e){this.button.disabled=e}}]),BasketView}(t),o="https://larek-api.nomoreparties.co/content/weblarek";function isSelector(e){return"string"==typeof e&&e.length>1}function ensureElement(e,t){if(isSelector(e)){var r=function ensureAllElements(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(isSelector(e))return Array.from(t.querySelectorAll(e));if(e instanceof NodeList)return Array.from(e);if(Array.isArray(e))return e;throw new Error("Unknown selector element")}(e,t);if(r.length>1&&console.warn("selector ".concat(e," return more then one element")),0===r.length)throw new Error("selector ".concat(e," return nothing"));return r.pop()}if(e instanceof HTMLElement)return e;throw new Error("Unknown selector element")}function cloneTemplate(e){return ensureElement(e).content.firstElementChild.cloneNode(!0)}function Card_typeof(e){return Card_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Card_typeof(e)}function Card_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Card_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Card_toPrimitive(e,t){if("object"!==Card_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Card_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Card_typeof(i)?i:String(i)),n)}var o,i}function Card_createClass(e,t,r){return t&&Card_defineProperties(e.prototype,t),r&&Card_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function Card_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Card_setPrototypeOf(e,t)}function Card_setPrototypeOf(e,t){return Card_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Card_setPrototypeOf(e,t)}function Card_createSuper(e){var t=function Card_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Card_getPrototypeOf(e);if(t){var o=Card_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Card_possibleConstructorReturn(e,t){if(t&&("object"===Card_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Card_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Card_getPrototypeOf(e){return Card_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Card_getPrototypeOf(e)}!function(e){e["софт-скил"]="_soft",e["другое"]="_other",e["дополнительное"]="_additional",e["кнопка"]="_button",e["хард-скил"]="_hard"}(r||(r={}));var i=function(e){Card_inherits(Merchandise,e);var t=Card_createSuper(Merchandise);function Merchandise(e,r){var n;return Card_classCallCheck(this,Merchandise),(n=t.call(this,e,r)).container=e,n.cardTitle=ensureElement(".card__title",n.container),n.cardPrice=ensureElement(".card__price",n.container),n}return Card_createClass(Merchandise,[{key:"_id",set:function set(e){this._id=e}},{key:"title",set:function set(e){this.cardTitle&&(this.cardTitle.textContent=e)}},{key:"price",set:function set(e){this.cardPrice.textContent="".concat(e," синапсов"),e||(this.cardPrice.textContent="Бесценно")}}]),Merchandise}(t),a=function(e){Card_inherits(Card,e);var t=Card_createSuper(Card);function Card(e,r){var n;return Card_classCallCheck(this,Card),(n=t.call(this,e,r)).container=e,n.cardImg=ensureElement(".card__image",n.container),n.cardCategory=ensureElement(".card__category",n.container),n.container.addEventListener("click",(function(e){e.preventDefault(),n.events.emit("catalog:preview",{product:n._data})})),n}return Card_createClass(Card,[{key:"category",set:function set(e){var t=this;if(this.cardCategory&&(this.cardCategory.textContent=e,Object.values(r).forEach((function(e){return t.cardCategory.classList.remove("card__category".concat(e))})),e in r)){var n=r[e];this.cardCategory.classList.add("card__category".concat(n))}}},{key:"image",set:function set(e){this.cardImg&&(this.cardImg.src="".concat(o).concat(e))}}]),Card}(i),c=function(e){Card_inherits(CardPreview,e);var t=Card_createSuper(CardPreview);function CardPreview(e,r){var n;return Card_classCallCheck(this,CardPreview),(n=t.call(this,e,r)).container=e,n.cardImg=ensureElement(".card__image",n.container),n.cardCategory=ensureElement(".card__category",n.container),n.cardDescription=ensureElement(".card__text",n.container),n.basketAddButton=ensureElement(".card__button",n.container),n}return Card_createClass(CardPreview,[{key:"image",set:function set(e){this.cardImg&&(this.cardImg.src="".concat(o).concat(e))}},{key:"description",set:function set(e){this.cardDescription&&(this.cardDescription.textContent=e)}},{key:"category",set:function set(e){var t=this;if(this.cardCategory&&(this.cardCategory.textContent=e,Object.values(r).forEach((function(e){return t.cardCategory.classList.remove("card__category".concat(e))})),e in r)){var n=r[e];this.cardCategory.classList.add("card__category".concat(n))}}},{key:"updateBasketButton",value:function updateBasketButton(e){var t=this;if(this.basketAddButton){var r=this.basketAddButton.cloneNode(!0);this.basketAddButton.replaceWith(r),this.basketAddButton=r;var n="number"==typeof e.price&&e.price>0;this.basketAddButton.disabled=!n,this.basketAddButton.textContent=n?e.inBasket?"Удалить из корзины":"В корзину":"Недоступно",n&&this.basketAddButton.addEventListener("click",(function(e){e.preventDefault(),t._data.inBasket?t.events.emit("basket:remove",{product:t._data}):t.events.emit("basket:add",{product:t._data}),t.events.emit("basket:changed",{product:t._data})}))}}}]),CardPreview}(i),s=function(e){Card_inherits(CardBasket,e);var t=Card_createSuper(CardBasket);function CardBasket(e,r){var n;return Card_classCallCheck(this,CardBasket),(n=t.call(this,e,r)).container=e,n.events=r,n.basketIndex=ensureElement(".basket__item-index",n.container),n.basketDeleteButton=ensureElement(".basket__item-delete",n.container),n.basketDeleteButton.addEventListener("click",(function(e){e.preventDefault(),n.events.emit("basket:remove",{product:n._data})})),n}return Card_createClass(CardBasket,[{key:"index",set:function set(e){this.basketIndex&&(this.basketIndex.textContent="".concat(e,"  "))}}]),CardBasket}(i);function Form_typeof(e){return Form_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Form_typeof(e)}function Form_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Form_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Form_toPrimitive(e,t){if("object"!==Form_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Form_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Form_typeof(i)?i:String(i)),n)}var o,i}function Form_createClass(e,t,r){return t&&Form_defineProperties(e.prototype,t),r&&Form_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}var u=function(){function OrderForm(e,t){var r=this;Form_classCallCheck(this,OrderForm),this.container=e,this.container=e,this.onlinePaymentButton=this.container.querySelector('button[name="card"]'),this.offlinePaymentButton=this.container.querySelector('button[name="cash"]'),this.addressInput=this.container.querySelector('input[name="address"]'),this.button=this.container.querySelector(".order__button"),this.onlinePaymentButton.addEventListener("click",(function(){return r.selectPayment("card")})),this.offlinePaymentButton.addEventListener("click",(function(){return r.selectPayment("cash")})),this.validateForm(),this.container.addEventListener("submit",(function(e){e.preventDefault(),t.emit("order:address",r.getData())})),this.addressInput.addEventListener("input",(function(){r.button.disabled=!(r.addressInput.value.trim()&&r.payment)}))}return Form_createClass(OrderForm,[{key:"selectPayment",value:function selectPayment(e){"card"===e?(this.onlinePaymentButton.classList.add("button_alt-active"),this.offlinePaymentButton.classList.remove("button_alt-active")):(this.offlinePaymentButton.classList.add("button_alt-active"),this.onlinePaymentButton.classList.remove("button_alt-active")),this.payment=e,this.validateForm()}},{key:"isFormValid",value:function isFormValid(){return""!==this.addressInput.value.trim()&&!!this.payment}},{key:"validateForm",value:function validateForm(){this.button.disabled=!this.isFormValid()}},{key:"getData",value:function getData(){return{payment:this.payment,address:this.addressInput.value.trim()}}},{key:"element",get:function get(){return this.container}}]),OrderForm}(),l=function(){function ContactForm(e,t){var r=this;Form_classCallCheck(this,ContactForm),this.container=e,this.container=e,this.emailInput=this.container.querySelector('input[name="email"]'),this.phoneInput=this.container.querySelector('input[name="phone"]'),this.button=this.container.querySelector('.button[type="submit"]'),this.validateForm(),this.emailInput.addEventListener("input",(function(){return r.validateForm()})),this.phoneInput.addEventListener("input",(function(){return r.validateForm()})),this.container.addEventListener("submit",(function(e){e.preventDefault(),t.emit("order:contact",r.getData())}))}return Form_createClass(ContactForm,[{key:"isFormValid",value:function isFormValid(){return""!==this.emailInput.value.trim()&&""!==this.phoneInput.value.trim()}},{key:"validateForm",value:function validateForm(){this.button.disabled=!this.isFormValid()}},{key:"getData",value:function getData(){return{email:this.emailInput.value.trim(),phone:this.phoneInput.value.trim()}}},{key:"element",get:function get(){return this.container}}]),ContactForm}();function Page_typeof(e){return Page_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Page_typeof(e)}function Page_toConsumableArray(e){return function Page_arrayWithoutHoles(e){if(Array.isArray(e))return Page_arrayLikeToArray(e)}(e)||function Page_iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function Page_unsupportedIterableToArray(e,t){if(!e)return;if("string"==typeof e)return Page_arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Page_arrayLikeToArray(e,t)}(e)||function Page_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Page_arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function Page_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Page_toPrimitive(e,t){if("object"!==Page_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Page_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Page_typeof(i)?i:String(i)),n)}var o,i}function Page_setPrototypeOf(e,t){return Page_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Page_setPrototypeOf(e,t)}function Page_createSuper(e){var t=function Page_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Page_getPrototypeOf(e);if(t){var o=Page_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Page_possibleConstructorReturn(e,t){if(t&&("object"===Page_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Page_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Page_getPrototypeOf(e){return Page_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Page_getPrototypeOf(e)}var f=function(e){!function Page_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Page_setPrototypeOf(e,t)}(Page,e);var t=Page_createSuper(Page);function Page(e,r){var n;return function Page_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Page),(n=t.call(this,e,r)).container=e,n.pageWrapperElement=ensureElement(".page__wrapper"),n.basketButton=document.querySelector(".header__basket"),n.counter=document.querySelector(".header__basket-counter"),n.basketButton.addEventListener("click",(function(e){e.preventDefault(),n.events.emit("catalog:basket")})),n}return function Page_createClass(e,t,r){return t&&Page_defineProperties(e.prototype,t),r&&Page_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Page,[{key:"setCount",value:function setCount(e){this.counter.textContent=e.toString()}},{key:"catalog",set:function set(e){var t;(t=this.container).replaceChildren.apply(t,Page_toConsumableArray(e))}},{key:"locked",set:function set(e){e?this.pageWrapperElement.classList.add("page__wrapper_locked"):this.pageWrapperElement.classList.remove("page__wrapper_locked")}}]),Page}(t);function Success_typeof(e){return Success_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Success_typeof(e)}function Success_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Success_toPrimitive(e,t){if("object"!==Success_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Success_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Success_typeof(i)?i:String(i)),n)}var o,i}var p=function(){function Success(e,t){!function Success_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Success),this.container=e,this.container=e,this.totalElement=ensureElement(".order-success__description",this.container),this.button=ensureElement(".order-success__close",this.container),this.button.addEventListener("click",(function(e){e.preventDefault(),t.emit("order:success")}))}return function Success_createClass(e,t,r){return t&&Success_defineProperties(e.prototype,t),r&&Success_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Success,[{key:"setTotalPrice",value:function setTotalPrice(e){this.totalElement.textContent="Списано ".concat(e.toString()," синапсов")}},{key:"element",get:function get(){return this.container}}]),Success}();function api_typeof(e){return api_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},api_typeof(e)}function api_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function api_toPrimitive(e,t){if("object"!==api_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==api_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===api_typeof(i)?i:String(i)),n)}var o,i}var d=function(){function Api(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function api_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Api),this.baseUrl=e,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(t=r.headers)&&void 0!==t?t:{})}}return function api_createClass(e,t,r){return t&&api_defineProperties(e.prototype,t),r&&api_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Api,[{key:"handleResponse",value:function handleResponse(e){return e.ok?e.json():e.json().then((function(t){var r;return Promise.reject(null!==(r=t.error)&&void 0!==r?r:e.statusText)}))}},{key:"get",value:function get(e){return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(t)})).then(this.handleResponse)}}]),Api}();function events_typeof(e){return events_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},events_typeof(e)}function events_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function events_toPrimitive(e,t){if("object"!==events_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==events_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===events_typeof(i)?i:String(i)),n)}var o,i}var y=function(){function EventEmitter(){!function events_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventEmitter),this._events=new Map}return function events_createClass(e,t,r){return t&&events_defineProperties(e.prototype,t),r&&events_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(EventEmitter,[{key:"on",value:function on(e,t){var r;this._events.has(e)||this._events.set(e,new Set),null===(r=this._events.get(e))||void 0===r||r.add(t)}},{key:"off",value:function off(e,t){var r;this._events.has(e)&&(this._events.get(e).delete(t),0===(null===(r=this._events.get(e))||void 0===r?void 0:r.size)&&this._events.delete(e))}},{key:"emit",value:function emit(e,t){this._events.forEach((function(r,n){"*"===n&&r.forEach((function(r){return r({eventName:e,data:t})})),(n instanceof RegExp&&n.test(e)||n===e)&&r.forEach((function(e){return e(t)}))}))}},{key:"onAll",value:function onAll(e){this.on("*",e)}},{key:"offAll",value:function offAll(){this._events=new Map}},{key:"trigger",value:function trigger(e,t){var r=this;return function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.emit(e,Object.assign(Object.assign({},n||{}),t||{}))}}}]),EventEmitter}();function Modal_typeof(e){return Modal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Modal_typeof(e)}function Modal_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function Modal_toPrimitive(e,t){if("object"!==Modal_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==Modal_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===Modal_typeof(i)?i:String(i)),n)}var o,i}function Modal_setPrototypeOf(e,t){return Modal_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Modal_setPrototypeOf(e,t)}function Modal_createSuper(e){var t=function Modal_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,n=Modal_getPrototypeOf(e);if(t){var o=Modal_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function Modal_possibleConstructorReturn(e,t){if(t&&("object"===Modal_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Modal_assertThisInitialized(e)}(this,r)}}function Modal_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Modal_getPrototypeOf(e){return Modal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Modal_getPrototypeOf(e)}var m=function(e){!function Modal_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Modal_setPrototypeOf(e,t)}(Modal,e);var t=Modal_createSuper(Modal);function Modal(e,r,n){var o;return function Modal_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Modal),(o=t.call(this,e,r)).container=e,o.handleEscPress=function(e){"Escape"===e.key&&o.close()},o.page=n,o.modal=ensureElement(".modal__content",o.container),o.closeButton=ensureElement(".modal__close",o.container),o.closeButton.addEventListener("click",(function(){o.close()})),o.container.addEventListener("click",(function(e){e.target===o.container&&o.close()})),o.handleEscPress=o.handleEscPress.bind(Modal_assertThisInitialized(o)),o}return function Modal_createClass(e,t,r){return t&&Modal_defineProperties(e.prototype,t),r&&Modal_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Modal,[{key:"open",value:function open(){this.container.classList.add("modal_active"),document.body.style.overflow="hidden",document.addEventListener("keydown",this.handleEscPress),this.events.emit("modal:open"),this.page&&(this.page.locked=!0)}},{key:"close",value:function close(){this.container.classList.remove("modal_active"),document.body.style.overflow="",document.removeEventListener("keydown",this.handleEscPress),this.modal.replaceChildren(),this.events.emit("modal:close"),this.page&&(this.page.locked=!1)}},{key:"setContent",value:function setContent(e){this.modal.replaceChildren(e)}}]),Modal}(t);function shopModel_typeof(e){return shopModel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},shopModel_typeof(e)}function shopModel_defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(o=n.key,i=void 0,i=function shopModel_toPrimitive(e,t){if("object"!==shopModel_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==shopModel_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o,"string"),"symbol"===shopModel_typeof(i)?i:String(i)),n)}var o,i}var b=function(){function ShopModel(e){!function shopModel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ShopModel),this.events=e,this._catalog=[],this._basket=[],this._preview=null,this._order={}}return function shopModel_createClass(e,t,r){return t&&shopModel_defineProperties(e.prototype,t),r&&shopModel_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ShopModel,[{key:"catalog",get:function get(){return this._catalog},set:function set(e){this._catalog=e}},{key:"basket",get:function get(){return this._basket}},{key:"getProduct",value:function getProduct(e){return this._catalog.find((function(t){return t.id===e}))}},{key:"addBasket",value:function addBasket(e){this.basket.push(e)}},{key:"removeBasket",value:function removeBasket(e){this._basket=this._basket.filter((function(t){return t.id!==e.id}))}},{key:"clearBasket",value:function clearBasket(){this._basket=[],this.events.emit("catalog:loaded")}},{key:"getBasketLength",value:function getBasketLength(){return this._basket.length}},{key:"getBasketTotalPrice",value:function getBasketTotalPrice(){return this._basket.reduce((function(e,t){return e+t.price}),0)}},{key:"setPreview",value:function setPreview(e){this._preview=e}},{key:"getPreview",value:function getPreview(){return this._preview}},{key:"isInBasket",value:function isInBasket(e){return this.basket.some((function(t){return t.id===e}))}},{key:"order",get:function get(){return this._order},set:function set(e){Object.assign(this.order,null!=e?e:{})}}]),ShopModel}(),v=document.querySelector(".gallery"),h=document.querySelector("#card-catalog"),_=document.querySelector("#card-basket"),g=document.querySelector("#card-preview"),P=document.querySelector(".modal"),k=document.querySelector("#basket"),C=document.querySelector("#order"),w=document.querySelector("#contacts"),S=document.querySelector("#success"),O=new y,j=new f(v,O),E=new b(O),B=new e(new d("https://larek-api.nomoreparties.co/api/weblarek")),T=new n(cloneTemplate(k),O),A=new m(P,O,j);B.getProductList().then((function(e){E.catalog=e.items,O.emit("catalog:loaded")})).catch((function(e){return console.log(e)})),O.on("catalog:loaded",(function(){var e=E.catalog.map((function(e){return Object.assign(Object.assign({},e),{inBasket:E.isInBasket(e.id)})}));E.catalog=e;var t=e.map((function(e){return new a(cloneTemplate(h),O).render(e)}));j.render({catalog:t}),j.setCount(E.getBasketLength())})),O.on("catalog:preview",(function(e){var t=e.product,r=E.getProduct(t.id),n=new c(cloneTemplate(g),O);n.updateBasketButton(r),A.setContent(n.render(r)),A.open()})),O.on("basket:add",(function(e){var t=e.product;E.addBasket(t),j.setCount(E.getBasketLength())})),O.on("basket:remove",(function(e){var t=e.product;E.removeBasket(t),j.setCount(E.getBasketLength());var r=E.catalog.map((function(e){return Object.assign(Object.assign({},e),{inBasket:E.isInBasket(e.id)})}));E.catalog=r;var n=E.getProduct(t.id),o=new c(cloneTemplate(g),O);A.setContent(o.render(n)),o.updateBasketButton(n),O.emit("catalog:basket")})),O.on("basket:changed",(function(e){var t=e.product;j.setCount(E.getBasketLength());var r=E.catalog.map((function(e){return Object.assign(Object.assign({},e),{inBasket:E.isInBasket(e.id)})}));E.catalog=r;var n=new c(cloneTemplate(g),O);A.setContent(n.render(E.getProduct(t.id))),n.updateBasketButton(E.getProduct(t.id))})),O.on("catalog:basket",(function(){T.setSubmitDisabled(E.getBasketTotalPrice()<=0);var e=E.basket.map((function(e,t){var r=new s(cloneTemplate(_),O);return r.index=t+1,r.render(e)}));T.setProduct(e),T.updateTotalPrice(E.getBasketTotalPrice()),A.setContent(T.element),A.open()})),O.on("order:submit",(function(){var e=new u(cloneTemplate(C),O);E.order.items=E.basket.filter((function(e){return null!=e.price&&e.price>0})).map((function(e){return e.id})),E.order.total=E.getBasketTotalPrice(),A.setContent(e.element)})),O.on("order:address",(function(e){var t=new l(cloneTemplate(w),O);E.order=e,A.setContent(t.element)})),O.on("order:contact",(function(e){E.order=e,B.sendOrder(E.order).then((function(e){var t=new p(cloneTemplate(S),O);t.setTotalPrice(E.order.total),E.clearBasket(),A.setContent(t.element)})).catch((function(e){console.log(e)}))})),O.on("order:success",(function(){A.close()}))})();
//# sourceMappingURL=main.js.map